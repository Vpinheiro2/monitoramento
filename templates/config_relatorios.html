{% extends "base.html" %}

{% block title %}Configura√ß√£o de Relat√≥rios{% endblock %}

{% block content %}
<div class="page-header" style="background: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem;">
    <h1 style="font-size: 2rem; color: var(--primary); margin-bottom: 0.5rem;">
        üìä Configura√ß√£o de Relat√≥rios
    </h1>
    <p style="color: #64748b;">
        <a href="{{ url_for('ti') }}" style="color: var(--primary);">‚Üê Voltar para TI</a>
    </p>
</div>

<div style="margin-bottom: 2rem;">
    <button onclick="openAddRelatorioModal()" class="btn btn-success">
        ‚ûï Criar Novo Relat√≥rio
    </button>
</div>

<div class="card">
    <h2 class="card-title">Relat√≥rios Configurados</h2>
    
    <table style="width: 100%; border-collapse: collapse;">
        <thead style="background: var(--primary); color: white;">
            <tr>
                <th style="padding: 1rem; text-align: left;">Nome</th>
                <th style="padding: 1rem; text-align: left;">Descri√ß√£o</th>
                <th style="padding: 1rem; text-align: left;">Tipo</th>
                <th style="padding: 1rem; text-align: left;">Formatos</th>
                <th style="padding: 1rem; text-align: left;">Status</th>
                <th style="padding: 1rem; text-align: left;">A√ß√µes</th>
            </tr>
        </thead>
        <tbody>
            {% for id_rel, rel in relatorios.items() %}
            <tr style="border-bottom: 1px solid #e2e8f0;">
                <td style="padding: 1rem;"><strong>{{ rel.nome }}</strong></td>
                <td style="padding: 1rem;">{{ rel.descricao }}</td>
                <td style="padding: 1rem;">
                    <span class="badge badge-info">{{ rel.tipo | capitalize }}</span>
                </td>
                <td style="padding: 1rem;">
                    {% for formato in rel.formatos %}
                    <span class="badge badge-secondary">{{ formato }}</span>
                    {% endfor %}
                </td>
                <td style="padding: 1rem;">
                    {% if rel.ativo %}
                    <span class="badge badge-success">‚úÖ Ativo</span>
                    {% else %}
                    <span class="badge badge-secondary">‚ùå Inativo</span>
                    {% endif %}
                </td>
                <td style="padding: 1rem;">
                    <div style="display: flex; gap: 0.5rem;">
                        <button onclick="editRelatorio('{{ id_rel }}')" class="btn btn-primary" style="padding: 0.5rem 0.75rem;">
                            ‚úèÔ∏è
                        </button>
                        <form method="POST" style="display: inline;">
                            <input type="hidden" name="acao" value="ativar_desativar">
                            <input type="hidden" name="id_relatorio" value="{{ id_rel }}">
                            <button type="submit" class="btn btn-warning" style="padding: 0.5rem 0.75rem;">
                                {% if rel.ativo %}üîí{% else %}üîì{% endif %}
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Modal Adicionar/Editar Relat√≥rio -->
<div id="relatorioModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; overflow-y: auto;">
    <div style="background: white; padding: 2rem; border-radius: 12px; max-width: 700px; width: 95%; margin: 2rem auto;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 id="relatorioModalTitle" style="font-size: 1.5rem; color: var(--primary); margin: 0;">‚ûï Criar Relat√≥rio</h2>
            <span onclick="closeRelatorioModal()" style="font-size: 2rem; cursor: pointer; color: #94a3b8;">&times;</span>
        </div>
        
        <form method="POST">
            <input type="hidden" name="acao" id="relAcao" value="adicionar">
            <input type="hidden" name="id_relatorio" id="relId">
            
            <div class="form-group">
                <label class="form-label">ID do Relat√≥rio * <small style="color: #64748b;">(sem espa√ßos)</small></label>
                <input type="text" name="id_relatorio" id="relIdInput" class="form-control" 
                       placeholder="ex: vendas_mensais" required>
            </div>

            <div class="form-group">
                <label class="form-label">Nome do Relat√≥rio *</label>
                <input type="text" name="nome" id="relNome" class="form-control" 
                       placeholder="Ex: Vendas Mensais" required>
            </div>

            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea name="descricao" id="relDescricao" class="form-control" rows="2" 
                          placeholder="Descri√ß√£o breve do relat√≥rio"></textarea>
            </div>

            <div class="form-group">
                <label class="form-label">Tipo *</label>
                <select name="tipo" id="relTipo" class="form-control" required>
                    <option value="">Selecione...</option>
                    <option value="processos">Processos</option>
                    <option value="equipamentos">Equipamentos</option>
                    <option value="manutencao">Manuten√ß√£o</option>
                    <option value="qualidade">Qualidade</option>
                </select>
            </div>

            <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                <label class="form-label" style="font-size: 1.1rem; margin-bottom: 1rem;">üìã Campos do Relat√≥rio * <small style="color: #64748b;">(selecione os dados que deseja exibir)</small></label>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 0.75rem; background: white; padding: 1rem; border-radius: 8px; max-height: 400px; overflow-y: auto;">
                    
                    <!-- DADOS DO PROCESSO -->
                    <div style="grid-column: 1 / -1; background: #e0f2fe; padding: 0.5rem; border-radius: 4px; font-weight: bold; color: #0369a1;">
                        üì¶ Dados do Processo
                    </div>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="id_processo">
                        <span>üî¢ ID do Processo</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="equipamento">
                        <span>üè≠ Equipamento</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="equipamento_id">
                        <span>üî¢ ID do Equipamento</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="tipo_equipamento">
                        <span>üè∑Ô∏è Tipo de Equipamento</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="localizacao_equipamento">
                        <span>üìç Localiza√ß√£o do Equipamento</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="produto">
                        <span>üì¶ Produto/Tipo</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="ordem_producao">
                        <span>üìã Ordem de Produ√ß√£o</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="lote">
                        <span>üè∑Ô∏è Lote</span>
                    </label>
                    
                    <!-- DADOS DE TEMPO -->
                    <div style="grid-column: 1 / -1; background: #fef3c7; padding: 0.5rem; border-radius: 4px; font-weight: bold; color: #92400e; margin-top: 0.5rem;">
                        ‚è∞ Datas e Hor√°rios
                    </div>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="data_inicio">
                        <span>üìÖ Data de In√≠cio</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="hora_inicio">
                        <span>üïê Hora de In√≠cio</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="data_finalizacao">
                        <span>üìÖ Data de Finaliza√ß√£o</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="hora_finalizacao">
                        <span>üïê Hora de Finaliza√ß√£o</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="duracao_processo">
                        <span>‚è±Ô∏è Dura√ß√£o do Processo</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="carregado_as">
                        <span>üïê Carregado √†s</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="tempo_total">
                        <span>‚è≥ Tempo Total</span>
                    </label>
                    
                    <!-- DADOS DE USU√ÅRIO -->
                    <div style="grid-column: 1 / -1; background: #dbeafe; padding: 0.5rem; border-radius: 4px; font-weight: bold; color: #1e40af; margin-top: 0.5rem;">
                        üë• Usu√°rios e Respons√°veis
                    </div>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="responsavel">
                        <span>üë§ Respons√°vel pelo Processo</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="usuario_inicio">
                        <span>üë§ Usu√°rio que Iniciou</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="usuario_finalizacao">
                        <span>üë§ Usu√°rio que Finalizou</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="analisado_por">
                        <span>üë§ Analisado por (Qualidade)</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="turno">
                        <span>üåì Turno</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="equipe">
                        <span>üë• Equipe</span>
                    </label>
                    
                    <!-- QUALIDADE -->
                    <div style="grid-column: 1 / -1; background: #dcfce7; padding: 0.5rem; border-radius: 4px; font-weight: bold; color: #166534; margin-top: 0.5rem;">
                        üî¨ Controle de Qualidade
                    </div>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="status_qualidade">
                        <span>‚úÖ Status de Qualidade</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="data_analise">
                        <span>üìÖ Data da An√°lise</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="hora_analise">
                        <span>üïê Hora da An√°lise</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="observacoes_qualidade">
                        <span>üìù Observa√ß√µes da Qualidade</span>
                    </label>
                    
                    <!-- TEMPERATURA E SENSORES -->
                    <div style="grid-column: 1 / -1; background: #fee2e2; padding: 0.5rem; border-radius: 4px; font-weight: bold; color: #991b1b; margin-top: 0.5rem;">
                        üå°Ô∏è Temperatura e Sensores
                    </div>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="temperatura_inicial">
                        <span>üå°Ô∏è Temperatura Inicial</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="temperatura_final">
                        <span>üå°Ô∏è Temperatura Final</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="temperatura_media">
                        <span>üå°Ô∏è Temperatura M√©dia</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="temperatura_minima">
                        <span>üå°Ô∏è Temperatura M√≠nima</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="temperatura_maxima">
                        <span>üå°Ô∏è Temperatura M√°xima</span>
                    </label>
                    
                    <!-- OUTROS -->
                    <div style="grid-column: 1 / -1; background: #f3e8ff; padding: 0.5rem; border-radius: 4px; font-weight: bold; color: #6b21a8; margin-top: 0.5rem;">
                        üìã Outros Dados
                    </div>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="status_processo">
                        <span>üìä Status do Processo</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="tipo_processo">
                        <span>üè∑Ô∏è Tipo de Processo</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="quantidade">
                        <span>üìä Quantidade</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="unidade_medida">
                        <span>üìè Unidade de Medida</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="observacoes">
                        <span>üìù Observa√ß√µes</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="prioridade">
                        <span>‚≠ê Prioridade</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="cliente">
                        <span>üè¢ Cliente</span>
                    </label>
                    
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='#f1f5f9'" onmouseout="this.style.background='transparent'">
                        <input type="checkbox" name="campos" value="pedido">
                        <span>üìã Pedido</span>
                    </label>
                </div>
                
                <div style="margin-top: 1rem; padding: 0.75rem; background: #e0f2fe; border-radius: 6px; font-size: 0.9rem; color: #0369a1;">
                    üí° <strong>Dica:</strong> Selecione apenas os campos que deseja exibir no relat√≥rio. Campos n√£o selecionados n√£o aparecer√£o.
                </div>
            </div>

            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                <label class="form-label">Formatos de Exporta√ß√£o *</label>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" name="formatos" value="excel">
                        <span>üìä Excel (.xlsx)</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" name="formatos" value="pdf">
                        <span>üìï PDF</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" name="formatos" value="csv">
                        <span>üìã CSV</span>
                    </label>
                </div>
            </div>

            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <button type="button" onclick="closeRelatorioModal()" class="btn btn-secondary">
                    ‚ùå Cancelar
                </button>
                <button type="submit" class="btn btn-success">
                    ‚úÖ Criar Relat√≥rio
                </button>
            </div>
        </form>
    </div>
</div>

<script>
const relatoriosData = {{ relatorios | tojson | safe }};

function openAddRelatorioModal() {
    document.getElementById('relatorioModalTitle').textContent = '‚ûï Criar Novo Relat√≥rio';
    document.getElementById('relAcao').value = 'adicionar';
    document.getElementById('relIdInput').readOnly = false;
    // Limpar form
    document.getElementById('relIdInput').value = '';
    document.getElementById('relNome').value = '';
    document.getElementById('relDescricao').value = '';
    document.getElementById('relTipo').value = '';
    document.querySelectorAll('input[name="formatos"]').forEach(cb => cb.checked = false);
    
    document.getElementById('relatorioModal').style.display = 'flex';
}

function editRelatorio(idRel) {
    const rel = relatoriosData[idRel];
    document.getElementById('relatorioModalTitle').textContent = '‚úèÔ∏è Editar Relat√≥rio';
    document.getElementById('relAcao').value = 'editar';
    document.getElementById('relIdInput').value = idRel;
    document.getElementById('relIdInput').readOnly = true;
    document.getElementById('relNome').value = rel.nome;
    document.getElementById('relDescricao').value = rel.descricao;
    document.getElementById('relTipo').value = rel.tipo;
    
    // Marcar formatos
    document.querySelectorAll('input[name="formatos"]').forEach(cb => {
        cb.checked = rel.formatos.includes(cb.value);
    });
    
    document.getElementById('relatorioModal').style.display = 'flex';
}

function closeRelatorioModal() {
    document.getElementById('relatorioModal').style.display = 'none';
}

window.onclick = function(event) {
    if (event.target.id === 'relatorioModal') {
        closeRelatorioModal();
    }
}
</script>
{% endblock %}